import{aj as W,z as g,D as $,k as B,F as X,c as Z,o as T,ab as a,p as f,m as L,f as v,a7 as ee,t as M,g as r,n as U,h as le,an as m,ai as te}from"./index-Bbxu-hwF.js";import{E as ae}from"./el-dialog-vToTh7IC.js";/* empty css                       *//* empty css                  */import{E as oe}from"./el-date-picker-BfLMO-gD.js";/* empty css                 */import"./el-scrollbar-3cDDDycq.js";import"./el-tag-Bw5e-AGx.js";import{E as se,a as ne}from"./el-select-C1GVOS-C.js";import{s as ie,a as re}from"./star-Df2_B9pP.js";import{e as ce}from"./index-Do1FYWDS.js";import{u as ue}from"./email-C4vNF3Zd.js";import{a as me,b as pe,c as de}from"./all-email-vo7Dk_i1.js";import{I as y}from"./iconify-B3RI33Gs.js";import{a as _}from"./day-DqhKKaq5.js";import{c as N}from"./clipboard-utils-CzPXxZBC.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as ye}from"./vnode-DNvBlgrq.js";import{E as he}from"./index-VQJnuaUD.js";import{E as ge}from"./index-Cz1gY7Av.js";import"./event-BB_Ol6Sd.js";import"./index-AhaUJ5LL.js";import"./dayjs.min-hQTDDp5o.js";import"./index-CVJxucxF.js";import"./index-CSd_hrra.js";import"./index-Dqe6e1WK.js";import"./time-utils-zC19Ghl9.js";import"./position-Y4NYiGiF.js";import"./throttle-7uJ_JKyK.js";import"./el-empty-ZKykvMmM.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-checkbox-D4gY4cUC.js";import"./index-DIm3wlTT.js";const ve={class:"email-list-box"},be={class:"search-type"},Ee={class:"clear-email"},Ve={class:"clear-button"},ke=Object.assign({name:"all-email"},{__name:"index",setup(Te){const{t:n}=W(),b=ue(),p=g(""),h=g({}),d=g(""),w=g(),E=g(!1),V=g(!1),F=()=>{w.value.toggleMenu()},l=$({timeSort:0,type:"receive",userEmail:null,accountEmail:null,name:null,subject:null,searchType:"name"}),o=$({subject:"",sendEmail:"",sendName:"",startTime:"",toEmail:"",endTime:"",type:"eq"});function S(){o.subject="",o.sendEmail="",o.sendName="",o.startTime="",o.toEmail="",o.endTime=""}function Y(){S(),o.type="eq",o.endTime="",p.value=null}const I=B(()=>{if(l.searchType==="user")return n("user");if(l.searchType==="account")return n("selectEmail");if(l.searchType==="name")return n("sender");if(l.searchType==="subject")return n("subject")}),C=B(()=>h.value?.emailList?.length>0),j=localStorage.getItem("all-email-params");if(j){const e=JSON.parse(j);l.type=e.type,l.timeSort=e.timeSort,l.status=e.status,l.searchType=e.searchType}X(()=>l,()=>{localStorage.setItem("all-email-params",JSON.stringify(l))},{deep:!0});function R(){E.value=!0}function q(){if(p.value&&(o.startTime=_(p.value[0]).format("YYYY-MM-DD HH:mm:ss"),o.endTime=_(p.value[1]).add(1,"day").format("YYYY-MM-DD HH:mm:ss")),!o.sendEmail&&!o.sendName&&!o.subject&&!o.toEmail&&!p.value){E.value=!1;return}ge.confirm(n("delAllEmailConfirm"),{confirmButtonText:n("confirm"),cancelButtonText:n("cancel"),type:"warning"}).then(()=>{V.value=!0,pe(o).then(()=>{m({message:n("clearSuccess"),type:"success",plain:!0}),S(),h.value.refreshList()}).finally(()=>{V.value=!1})})}function H(){d.value=null,l.timeSort=0,l.type="receive",l.userEmail=null,l.accountEmail=null,l.name=null,l.subject=null,l.searchType="name"}async function O(){try{const e=h.value?.emailList;if(!e||e.length===0){m({message:n("noEmailsFound"),type:"warning",plain:!0});return}const t=e[0];let s="";if(t.type===0?s=t.toEmail:s=t.sendEmail,!s){m({message:n("noRecipientFound"),type:"warning",plain:!0});return}await N(s),m({message:n("copySuccessMsg")+": "+s,type:"success",plain:!0})}catch(e){console.error("复制收件人邮箱失败:",e),m({message:n("copyFailMsg"),type:"error",plain:!0})}}function P(e){const t=[/verification code is:?\s*(\d{4,8})/i,/verification code:?\s*(\d{4,8})/i,/code is:?\s*(\d{4,8})/i,/code:?\s*(\d{4,8})/i,/验证码:?\s*(\d{4,8})/i,/验证码是:?\s*(\d{4,8})/i,/(\d{6})/g,/(\d{4})/g,/(\d{5})/g,/(\d{8})/g];if(e.subject)for(const u of t){const c=e.subject.match(u);if(c)return c[1]||c[0]}let s="";if(e.content){const u=document.createElement("div");u.innerHTML=e.content,s=u.textContent||u.innerText||""}else e.text&&(s=e.text);if(s)for(const u of t){const c=s.match(u);if(c)return c[1]||c[0]}return null}async function z(){try{const e=h.value?.emailList;if(!e||e.length===0){m({message:n("noEmailsFound"),type:"warning",plain:!0});return}let t=null;for(const s of e)if(t=P(s),t)break;if(!t){m({message:n("noVerificationCodeFound")+"，"+n("tryRefreshEmails"),type:"warning",plain:!0});return}await N(t),m({message:n("copySuccessMsg")+": "+t,type:"success",plain:!0})}catch(e){console.error("复制验证码失败:",e),m({message:n("copyFailMsg"),type:"error",plain:!0})}}function k(){l.userEmail=null,l.accountEmail=null,l.name=null,l.subject=null,l.searchType==="user"&&(l.userEmail=d.value),l.searchType==="account"&&(l.accountEmail=d.value),l.searchType==="name"&&(l.name=d.value),l.searchType==="subject"&&(l.subject=d.value),h.value.refreshList()}function D(){l.timeSort=l.timeSort?0:1,k()}function A(){k()}function J(e){b.contentData.email=e,b.contentData.delType="physics",b.contentData.showStar=!1,b.contentData.showReply=!1,te.push({name:"content"})}function x(e,t){return de({emailId:e,size:t,...l})}return(e,t)=>{const s=ne,u=se,c=ye,G=oe,K=he,Q=ae;return T(),Z("div",ve,[a(ce,{ref_key:"sysEmailScroll",ref:h,"get-emailList":x,"email-delete":r(me),"star-add":r(re),"star-cancel":r(ie),"show-star":!1,"show-user-info":"","show-status":"",actionLeft:"4px","show-account-icon":!1,onJump:J,onRefreshBefore:H,type:"all-email"},{first:f(()=>[a(c,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=i=>d.value=i),placeholder:e.$t("searchByContent"),class:"search-input"},{prefix:f(()=>[v("div",{onClick:ee(F,["stop"])},[a(u,{ref_key:"mySelect",ref:w,modelValue:l.searchType,"onUpdate:modelValue":t[0]||(t[0]=i=>l.searchType=i),placeholder:e.$t("select"),class:"select"},{default:f(()=>[a(s,{key:"3",label:e.$t("sender"),value:"name"},null,8,["label"]),a(s,{key:"4",label:e.$t("subject"),value:"subject"},null,8,["label"]),a(s,{key:"1",label:e.$t("user"),value:"user"},null,8,["label"]),a(s,{key:"2",label:e.$t("selectEmail"),value:"account"},null,8,["label"])]),_:1},8,["modelValue","placeholder"]),v("div",be,[v("span",null,M(I.value),1),a(r(y),{class:"setting-icon",icon:"mingcute:down-small-fill",width:"20",height:"20"})])])]),_:1},8,["modelValue","placeholder"]),a(u,{modelValue:l.type,"onUpdate:modelValue":t[2]||(t[2]=i=>l.type=i),placeholder:"Select",class:"status-select",onChange:A},{default:f(()=>[a(s,{key:"1",label:e.$t("all"),value:"all"},null,8,["label"]),a(s,{key:"3",label:e.$t("received"),value:"receive"},null,8,["label"]),a(s,{key:"2",label:e.$t("sent"),value:"send"},null,8,["label"]),a(s,{key:"4",label:e.$t("selectDeleted"),value:"delete"},null,8,["label"]),a(s,{key:"4",label:e.$t("noRecipientTitle"),value:"noone"},null,8,["label"])]),_:1},8,["modelValue"]),a(r(y),{class:"icon",icon:"iconoir:search",onClick:k,width:"20",height:"20"}),l.timeSort===0?(T(),L(r(y),{key:0,class:"icon",onClick:D,icon:"material-symbols-light:timer-arrow-down-outline",width:"28",height:"28"})):(T(),L(r(y),{key:1,class:"icon",onClick:D,icon:"material-symbols-light:timer-arrow-up-outline",width:"28",height:"28"})),a(r(y),{class:"icon clear",icon:"fluent:broom-sparkle-16-regular",width:"22",height:"22",onClick:R}),a(r(y),{class:U(["icon",{disabled:!C.value}]),icon:"mdi-light:email-outline",width:"20",height:"20",onClick:O,title:e.$t("copyFirstRecipient")},null,8,["class","title"]),a(r(y),{class:U(["icon",{disabled:!C.value}]),icon:"mdi:key-outline",width:"20",height:"20",onClick:z,title:e.$t("copyVerificationCode")},null,8,["class","title"])]),_:1},8,["email-delete","star-add","star-cancel"]),a(Q,{modelValue:E.value,"onUpdate:modelValue":t[9]||(t[9]=i=>E.value=i),title:e.$t("clearEmail"),width:"335",onClosed:Y},{default:f(()=>[v("div",Ee,[a(c,{modelValue:o.sendName,"onUpdate:modelValue":t[3]||(t[3]=i=>o.sendName=i),placeholder:e.$t("sender")},null,8,["modelValue","placeholder"]),a(c,{modelValue:o.subject,"onUpdate:modelValue":t[4]||(t[4]=i=>o.subject=i),placeholder:e.$t("subject")},null,8,["modelValue","placeholder"]),a(c,{modelValue:o.sendEmail,"onUpdate:modelValue":t[5]||(t[5]=i=>o.sendEmail=i),placeholder:e.$t("sendEmailAddress")},null,8,["modelValue","placeholder"]),a(c,{modelValue:o.toEmail,"onUpdate:modelValue":t[6]||(t[6]=i=>o.toEmail=i),placeholder:e.$t("toEmail")},null,8,["modelValue","placeholder"]),a(G,{"popper-class":"my-date-picker",modelValue:p.value,"onUpdate:modelValue":t[7]||(t[7]=i=>p.value=i),type:"daterange",teleported:!1,"unlink-panels":"","range-separator":r(n)("to"),size:"default"},null,8,["modelValue","range-separator"]),v("div",Ve,[a(u,{modelValue:o.type,"onUpdate:modelValue":t[8]||(t[8]=i=>o.type=i),style:{width:"200px"}},{default:f(()=>[a(s,{key:"eq",label:r(n)("equal"),value:"eq"},null,8,["label"]),a(s,{key:"left",label:r(n)("leading"),value:"left"},null,8,["label"]),a(s,{key:"include",label:r(n)("include"),value:"include"},null,8,["label"])]),_:1},8,["modelValue"]),a(K,{loading:V.value,type:"primary",onClick:q},{default:f(()=>[le(M(r(n)("clear")),1)]),_:1},8,["loading"])])])]),_:1},8,["modelValue","title"])])}}}),al=fe(ke,[["__scopeId","data-v-4bcb840f"]]);export{al as default};
